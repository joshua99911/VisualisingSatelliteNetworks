<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="https://joshua99911.github.io/VisualisingSatelliteNetworks/Emulation/frr_topo/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Frr_Topo - Visualising Satellite Networks</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/fontawesome.min.css" rel="stylesheet">
        <link href="../../css/brands.min.css" rel="stylesheet">
        <link href="../../css/solid.min.css" rel="stylesheet">
        <link href="../../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <link href="../../assets/_mkdocstrings.css" rel="stylesheet">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">Visualising Satellite Networks</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="nav-item">
                                <a href="../.." class="nav-link">Home</a>
                            </li>
                            <li class="nav-item">
                                <a href="../../about/" class="nav-link">About</a>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle active" aria-current="page" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Emulation</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../purpose/" class="dropdown-item">Purpose</a>
</li>
                                    
<li>
    <a href="../torus_topo/" class="dropdown-item">Torus_Topo</a>
</li>
                                    
<li>
    <a href="../simclient/" class="dropdown-item">simclient</a>
</li>
                                    
<li>
    <a href="../simapi/" class="dropdown-item">simapi</a>
</li>
                                    
<li>
    <a href="../run_mn/" class="dropdown-item">Run_MN</a>
</li>
                                    
<li>
    <a href="../pmonitor/" class="dropdown-item">Pmonitor</a>
</li>
                                    
<li>
    <a href="../geosimsat/" class="dropdown-item">Geosimsat</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active" aria-current="page">Frr_Topo</a>
</li>
                                    
<li>
    <a href="../frr_config_topo/" class="dropdown-item">Frr_Config_Topo</a>
</li>
                                    
<li>
    <a href="../driver/" class="dropdown-item">Driver</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Simulation</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../Simulation/simulation/" class="dropdown-item">Simulation</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item">
                                <a href="../../Setup/" class="nav-link">Setup</a>
                            </li>
                            <li class="nav-item">
                                <a href="../../DocStrings/" class="nav-link">DocStrings</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../geosimsat/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../frr_config_topo/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="https://github.com/joshua99911/VisualisingSatelliteNetworks/edit/master/docs/Emulation/frr_topo.md" class="nav-link"><i class="fa-brands fa-github"></i> Edit on GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="1"><a href="#frr_topo" class="nav-link">Frr_Topo</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="2"><a href="#emulation.mnet.frr_topo" class="nav-link">frr_topo</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#emulation.mnet.frr_topo.FrrRouter" class="nav-link">FrrRouter</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#emulation.mnet.frr_topo.FrrSimRuntime" class="nav-link">FrrSimRuntime</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#emulation.mnet.frr_topo.GroundStation" class="nav-link">GroundStation</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#emulation.mnet.frr_topo.MNetNodeWrap" class="nav-link">MNetNodeWrap</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#emulation.mnet.frr_topo.NetxTopo" class="nav-link">NetxTopo</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#emulation.mnet.frr_topo.RouteNode" class="nav-link">RouteNode</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#emulation.mnet.frr_topo.StubMininet" class="nav-link">StubMininet</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="frr_topo">Frr_Topo</h1>


<div class="doc doc-object doc-module">



<a id="emulation.mnet.frr_topo"></a>
    <div class="doc doc-contents first">

        <p>This module provides a comprehensive framework for simulating a network of routers, satellites, 
and ground stations using Mininet and FRR (Free Range Routing). The simulation supports dynamic 
network topologies, monitoring, and routing configurations.</p>


<details class="key-features" open>
  <summary>Key Features</summary>
  <ul>
<li>Custom Mininet node types with advanced routing capabilities.</li>
<li>Ground station and satellite network emulation.</li>
<li>Integration with FRR for dynamic routing protocols like OSPF.</li>
<li>Dynamic uplink management and monitoring.</li>
</ul>
</details>

<p><span class="doc-section-title">Classes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="emulation.mnet.frr_topo.- `RouteNode`">- `RouteNode`</span></code></td>
            <td>
              <div class="doc-md-description">
                <p>Mininet node with support for loopback interfaces.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="emulation.mnet.frr_topo.- `MNetNodeWrap`">- `MNetNodeWrap`</span></code></td>
            <td>
              <div class="doc-md-description">
                <p>Wrapper class for managing Mininet nodes.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="emulation.mnet.frr_topo.- `GroundStation`">- `GroundStation`</span></code></td>
            <td>
              <div class="doc-md-description">
                <p>Specialized node for simulating ground stations.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="emulation.mnet.frr_topo.- `FrrRouter`">- `FrrRouter`</span></code></td>
            <td>
              <div class="doc-md-description">
                <p>Node for simulating FRR routers.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="emulation.mnet.frr_topo.- `NetxTopo`">- `NetxTopo`</span></code></td>
            <td>
              <div class="doc-md-description">
                <p>Topology for building virtual networks using a <code>networkx.Graph</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="emulation.mnet.frr_topo.- `FrrSimRuntime`">- `FrrSimRuntime`</span></code></td>
            <td>
              <div class="doc-md-description">
                <p>Runtime manager for controlling the simulation.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="dependencies" open>
  <summary>Dependencies</summary>
  <ul>
<li>Mininet</li>
<li>NetworkX</li>
<li>FRR (Free Range Routing)</li>
<li>SQLite for monitoring and status tracking.</li>
</ul>
</details>







  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="emulation.mnet.frr_topo.FrrRouter" class="doc doc-heading">
            <code>FrrRouter</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="emulation.mnet.frr_topo.MNetNodeWrap" href="#emulation.mnet.frr_topo.MNetNodeWrap">MNetNodeWrap</a></code></p>


        <p>Support an FRR router under mininet.
- handles the the FRR config files, starting and stopping FRR.
Does not cleanup config files.</p>






              <details class="quote">
                <summary>Source code in <code>emulation/mnet/frr_topo.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">FrrRouter</span><span class="p">(</span><span class="n">MNetNodeWrap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Support an FRR router under mininet.</span>
<span class="sd">    - handles the the FRR config files, starting and stopping FRR.</span>
<span class="sd">    Does not cleanup config files.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">CFG_DIR</span> <span class="o">=</span> <span class="s2">&quot;/etc/frr/</span><span class="si">{node}</span><span class="s2">&quot;</span>
    <span class="n">VTY_DIR</span> <span class="o">=</span> <span class="s2">&quot;/var/frr/</span><span class="si">{node}</span><span class="s2">/</span><span class="si">{daemon}</span><span class="s2">.vty&quot;</span>
    <span class="n">LOG_DIR</span> <span class="o">=</span> <span class="s2">&quot;/var/log/frr/</span><span class="si">{node}</span><span class="s2">&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">default_ip</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">default_ip</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">no_frr</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtysh</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">daemons</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ospf</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">configure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vtysh</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">daemons</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">ospf</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set the configuration files for the router.</span>

<span class="sd">        Args:</span>
<span class="sd">            vtysh (str): Contents of the `vtysh.conf` file.</span>
<span class="sd">            daemons (str): Contents of the `daemons` file.</span>
<span class="sd">            ospf (str): Contents of the `frr.conf` file.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">vtysh</span> <span class="o">=</span> <span class="n">vtysh</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">daemons</span> <span class="o">=</span> <span class="n">daemons</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ospf</span> <span class="o">=</span> <span class="n">ospf</span>

    <span class="k">def</span> <span class="nf">write_configs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Write the router&#39;s configuration files to the appropriate directories.</span>

<span class="sd">        Creates:</span>
<span class="sd">            - Configuration files for the router, if not already present.</span>
<span class="sd">            - Logging and configuration directories for the router.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1"># Get frr config and save to frr config directory</span>
        <span class="n">cfg_dir</span> <span class="o">=</span> <span class="n">FrrRouter</span><span class="o">.</span><span class="n">CFG_DIR</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">node</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">log_dir</span> <span class="o">=</span> <span class="n">FrrRouter</span><span class="o">.</span><span class="n">LOG_DIR</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">node</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

        <span class="c1"># Suport this for running without mininet / FRR</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">no_frr</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: not running FRR&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">uinfo</span> <span class="o">=</span> <span class="n">pwd</span><span class="o">.</span><span class="n">getpwnam</span><span class="p">(</span><span class="s2">&quot;frr&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">cfg_dir</span><span class="p">):</span>
            <span class="c1"># sudo install -m 775 -o frr -g frrvty -d {cfg_dir}</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;create </span><span class="si">{</span><span class="n">cfg_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">cfg_dir</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="mo">0o775</span><span class="p">)</span>
            <span class="n">gid</span> <span class="o">=</span> <span class="n">grp</span><span class="o">.</span><span class="n">getgrnam</span><span class="p">(</span><span class="s2">&quot;frrvty&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">gr_gid</span>
            <span class="n">os</span><span class="o">.</span><span class="n">chown</span><span class="p">(</span><span class="n">cfg_dir</span><span class="p">,</span> <span class="n">uinfo</span><span class="o">.</span><span class="n">pw_uid</span><span class="p">,</span> <span class="n">gid</span><span class="p">)</span>

        <span class="c1"># sudo install -m 775 -o frr -g frr -d  {log_dir}</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">log_dir</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;create </span><span class="si">{</span><span class="n">log_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">log_dir</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="mo">0o775</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">chown</span><span class="p">(</span><span class="n">log_dir</span><span class="p">,</span> <span class="n">uinfo</span><span class="o">.</span><span class="n">pw_uid</span><span class="p">,</span> <span class="n">uinfo</span><span class="o">.</span><span class="n">pw_gid</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">write_cfg_file</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cfg_dir</span><span class="si">}</span><span class="s2">/vtysh.conf&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtysh</span><span class="p">,</span> <span class="n">uinfo</span><span class="o">.</span><span class="n">pw_uid</span><span class="p">,</span> <span class="n">uinfo</span><span class="o">.</span><span class="n">pw_gid</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_cfg_file</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cfg_dir</span><span class="si">}</span><span class="s2">/daemons&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">daemons</span><span class="p">,</span> <span class="n">uinfo</span><span class="o">.</span><span class="n">pw_uid</span><span class="p">,</span> <span class="n">uinfo</span><span class="o">.</span><span class="n">pw_gid</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_cfg_file</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cfg_dir</span><span class="si">}</span><span class="s2">/frr.conf&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ospf</span><span class="p">,</span> <span class="n">uinfo</span><span class="o">.</span><span class="n">pw_uid</span><span class="p">,</span> <span class="n">uinfo</span><span class="o">.</span><span class="n">pw_gid</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">net</span><span class="p">:</span> <span class="n">mininet</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="n">Mininet</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">net</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">node</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">no_frr</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_configs</span><span class="p">()</span>
        <span class="c1"># Start frr daemons</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;start router </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sendCmd</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;/usr/lib/frr/frrinit.sh start &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="c1"># Cleanup and stop frr daemons</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;stop router </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sendCmd</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;/usr/lib/frr/frrinit.sh stop &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">config_frr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">daemon</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">commands</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Send configuration commands to an FRR daemon.</span>

<span class="sd">        Args:</span>
<span class="sd">            daemon (str): Name of the FRR daemon (e.g., &quot;ospfd&quot;).</span>
<span class="sd">            commands (list[str]): List of configuration commands.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: True if all commands were successfully executed, False otherwise.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">node</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Running in stub mode</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="n">sock</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_UNIX</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">FrrRouter</span><span class="o">.</span><span class="n">VTY_DIR</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">node</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">daemon</span><span class="o">=</span><span class="n">daemon</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sock</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;enable</span><span class="se">\x00</span><span class="s1">&#39;</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_frr_cmd</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;conf term file-lock</span><span class="se">\x00</span><span class="s1">&#39;</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_frr_cmd</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="n">commands</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sending command </span><span class="si">{</span><span class="n">command</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="n">command</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;ascii&quot;</span><span class="p">)</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_frr_cmd</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;end</span><span class="se">\x00</span><span class="s1">&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_frr_cmd</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;disable</span><span class="se">\x00</span><span class="s1">&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_send_frr_cmd</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TimeoutError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;timout connecting to FRR&quot;</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">sock</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_send_frr_cmd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sock</span><span class="p">,</span> <span class="n">msg</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="n">sock</span><span class="o">.</span><span class="n">sendall</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">sock</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
        <span class="n">size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">data</span><span class="p">[</span><span class="n">size</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">write_cfg_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">contents</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">uid</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">gid</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">no_frr</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;write </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">contents</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chmod</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="mo">0o640</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chown</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">uid</span><span class="p">,</span> <span class="n">gid</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="emulation.mnet.frr_topo.FrrRouter.config_frr" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">config_frr</span><span class="p">(</span><span class="n">daemon</span><span class="p">,</span> <span class="n">commands</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Send configuration commands to an FRR daemon.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>daemon</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the FRR daemon (e.g., "ospfd").</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>commands</code>
            </td>
            <td>
                  <code>list[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of configuration commands.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if all commands were successfully executed, False otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>emulation/mnet/frr_topo.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">config_frr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">daemon</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">commands</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Send configuration commands to an FRR daemon.</span>

<span class="sd">    Args:</span>
<span class="sd">        daemon (str): Name of the FRR daemon (e.g., &quot;ospfd&quot;).</span>
<span class="sd">        commands (list[str]): List of configuration commands.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True if all commands were successfully executed, False otherwise.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">node</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Running in stub mode</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="n">sock</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_UNIX</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">FrrRouter</span><span class="o">.</span><span class="n">VTY_DIR</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">node</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">daemon</span><span class="o">=</span><span class="n">daemon</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">sock</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;enable</span><span class="se">\x00</span><span class="s1">&#39;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_frr_cmd</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;conf term file-lock</span><span class="se">\x00</span><span class="s1">&#39;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_frr_cmd</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="n">commands</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sending command </span><span class="si">{</span><span class="n">command</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="n">command</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;ascii&quot;</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_frr_cmd</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;end</span><span class="se">\x00</span><span class="s1">&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_frr_cmd</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;disable</span><span class="se">\x00</span><span class="s1">&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_frr_cmd</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TimeoutError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;timout connecting to FRR&quot;</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">sock</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="emulation.mnet.frr_topo.FrrRouter.configure" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">configure</span><span class="p">(</span><span class="n">vtysh</span><span class="p">,</span> <span class="n">daemons</span><span class="p">,</span> <span class="n">ospf</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Set the configuration files for the router.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>vtysh</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Contents of the <code>vtysh.conf</code> file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>daemons</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Contents of the <code>daemons</code> file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ospf</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Contents of the <code>frr.conf</code> file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>emulation/mnet/frr_topo.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">configure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vtysh</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">daemons</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">ospf</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Set the configuration files for the router.</span>

<span class="sd">    Args:</span>
<span class="sd">        vtysh (str): Contents of the `vtysh.conf` file.</span>
<span class="sd">        daemons (str): Contents of the `daemons` file.</span>
<span class="sd">        ospf (str): Contents of the `frr.conf` file.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">vtysh</span> <span class="o">=</span> <span class="n">vtysh</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">daemons</span> <span class="o">=</span> <span class="n">daemons</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ospf</span> <span class="o">=</span> <span class="n">ospf</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="emulation.mnet.frr_topo.FrrRouter.write_configs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_configs</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Write the router's configuration files to the appropriate directories.</p>


<details class="creates" open>
  <summary>Creates</summary>
  <ul>
<li>Configuration files for the router, if not already present.</li>
<li>Logging and configuration directories for the router.</li>
</ul>
</details>
            <details class="quote">
              <summary>Source code in <code>emulation/mnet/frr_topo.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">write_configs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Write the router&#39;s configuration files to the appropriate directories.</span>

<span class="sd">    Creates:</span>
<span class="sd">        - Configuration files for the router, if not already present.</span>
<span class="sd">        - Logging and configuration directories for the router.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="c1"># Get frr config and save to frr config directory</span>
    <span class="n">cfg_dir</span> <span class="o">=</span> <span class="n">FrrRouter</span><span class="o">.</span><span class="n">CFG_DIR</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">node</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="n">log_dir</span> <span class="o">=</span> <span class="n">FrrRouter</span><span class="o">.</span><span class="n">LOG_DIR</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">node</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="c1"># Suport this for running without mininet / FRR</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">no_frr</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: not running FRR&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="n">uinfo</span> <span class="o">=</span> <span class="n">pwd</span><span class="o">.</span><span class="n">getpwnam</span><span class="p">(</span><span class="s2">&quot;frr&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">cfg_dir</span><span class="p">):</span>
        <span class="c1"># sudo install -m 775 -o frr -g frrvty -d {cfg_dir}</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;create </span><span class="si">{</span><span class="n">cfg_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">cfg_dir</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="mo">0o775</span><span class="p">)</span>
        <span class="n">gid</span> <span class="o">=</span> <span class="n">grp</span><span class="o">.</span><span class="n">getgrnam</span><span class="p">(</span><span class="s2">&quot;frrvty&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">gr_gid</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chown</span><span class="p">(</span><span class="n">cfg_dir</span><span class="p">,</span> <span class="n">uinfo</span><span class="o">.</span><span class="n">pw_uid</span><span class="p">,</span> <span class="n">gid</span><span class="p">)</span>

    <span class="c1"># sudo install -m 775 -o frr -g frr -d  {log_dir}</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">log_dir</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;create </span><span class="si">{</span><span class="n">log_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">log_dir</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="mo">0o775</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chown</span><span class="p">(</span><span class="n">log_dir</span><span class="p">,</span> <span class="n">uinfo</span><span class="o">.</span><span class="n">pw_uid</span><span class="p">,</span> <span class="n">uinfo</span><span class="o">.</span><span class="n">pw_gid</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">write_cfg_file</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cfg_dir</span><span class="si">}</span><span class="s2">/vtysh.conf&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtysh</span><span class="p">,</span> <span class="n">uinfo</span><span class="o">.</span><span class="n">pw_uid</span><span class="p">,</span> <span class="n">uinfo</span><span class="o">.</span><span class="n">pw_gid</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">write_cfg_file</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cfg_dir</span><span class="si">}</span><span class="s2">/daemons&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">daemons</span><span class="p">,</span> <span class="n">uinfo</span><span class="o">.</span><span class="n">pw_uid</span><span class="p">,</span> <span class="n">uinfo</span><span class="o">.</span><span class="n">pw_gid</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">write_cfg_file</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cfg_dir</span><span class="si">}</span><span class="s2">/frr.conf&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ospf</span><span class="p">,</span> <span class="n">uinfo</span><span class="o">.</span><span class="n">pw_uid</span><span class="p">,</span> <span class="n">uinfo</span><span class="o">.</span><span class="n">pw_gid</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="emulation.mnet.frr_topo.FrrSimRuntime" class="doc doc-heading">
            <code>FrrSimRuntime</code>


</h2>


    <div class="doc doc-contents ">


        <p>Code for the FRR / Mininet / Monitoring functions.</p>






              <details class="quote">
                <summary>Source code in <code>emulation/mnet/frr_topo.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">FrrSimRuntime</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Code for the FRR / Mininet / Monitoring functions.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">topo</span><span class="p">:</span> <span class="n">NetxTopo</span><span class="p">,</span> <span class="n">net</span><span class="p">:</span> <span class="n">mininet</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="n">Mininet</span><span class="p">,</span> <span class="n">stable_monitor</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="o">=</span> <span class="n">topo</span><span class="o">.</span><span class="n">graph</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">MNetNodeWrap</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">routers</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">FrrRouter</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ground_stations</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">GroundStation</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stable_monitor</span> <span class="o">=</span> <span class="n">stable_monitor</span>

        <span class="c1"># Create monitoring DB file.</span>
        <span class="n">fd</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">db_file</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mkstemp</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="s2">&quot;.sqlite&quot;</span><span class="p">)</span>
        <span class="nb">open</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Master db file </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">db_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">frr_router</span> <span class="ow">in</span> <span class="n">topo</span><span class="o">.</span><span class="n">routers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">frr_router</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">frr_router</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">routers</span><span class="p">[</span><span class="n">frr_router</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">frr_router</span>
        <span class="k">for</span> <span class="n">ground_station</span> <span class="ow">in</span> <span class="n">topo</span><span class="o">.</span><span class="n">ground_stations</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">ground_station</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">ground_station</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ground_stations</span><span class="p">[</span><span class="n">ground_station</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">ground_station</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">stat_samples</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">net</span> <span class="o">=</span> <span class="n">net</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stub_net</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># If net is none, we are running in a stub mode without mininet or FRR.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">net</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">net</span> <span class="o">=</span> <span class="n">StubMininet</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stub_net</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">start_routers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Start all routers and monitoring processes in the simulation.</span>

<span class="sd">        Populates the monitoring database with target information and launches</span>
<span class="sd">        monitoring threads for dynamic and stable nodes.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1"># Populate master db file</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># Stable targets - to monitor</span>
        <span class="k">for</span> <span class="n">router</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">routers</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">router</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">router</span><span class="o">.</span><span class="n">defaultIP</span><span class="p">(),</span> <span class="n">router</span><span class="o">.</span><span class="n">stable_node</span><span class="p">()))</span>
        <span class="c1"># Not stable targets - don&#39;t monitor</span>
        <span class="k">for</span> <span class="n">station</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ground_stations</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">station</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">station</span><span class="o">.</span><span class="n">defaultIP</span><span class="p">(),</span> <span class="n">station</span><span class="o">.</span><span class="n">stable_node</span><span class="p">()))</span>
        <span class="n">pmonitor</span><span class="o">.</span><span class="n">init_targets</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db_file</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

        <span class="c1"># Start all nodes</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">node</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">net</span><span class="p">)</span>

        <span class="c1"># Wait for start to complete.</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">node</span><span class="o">.</span><span class="n">waitOutput</span><span class="p">()</span>

        <span class="c1"># Start monitoring on all nodes</span>
        <span class="n">db_master</span> <span class="o">=</span> <span class="n">pmonitor</span><span class="o">.</span><span class="n">open_db</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db_file</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="c1"># Start monitor if node is not considered always reachable</span>
            <span class="c1"># or we are running monitoring from the stable nodes.</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stable_monitor</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">node</span><span class="o">.</span><span class="n">stable_node</span><span class="p">():</span>
                <span class="n">node</span><span class="o">.</span><span class="n">startMonitor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db_file</span><span class="p">,</span> <span class="n">db_master</span><span class="p">)</span>
        <span class="n">db_master</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="c1"># Wait for monitoring to start</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stable_monitor</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">node</span><span class="o">.</span><span class="n">stable_node</span><span class="p">():</span>
                <span class="n">node</span><span class="o">.</span><span class="n">waitOutput</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">stop_routers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Stop all routers and monitoring processes in the simulation.</span>

<span class="sd">        Performs cleanup of monitoring databases and network resources.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1"># Stop monitor on all nodes</span>
        <span class="n">db_master</span> <span class="o">=</span> <span class="n">pmonitor</span><span class="o">.</span><span class="n">open_db</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db_file</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">node</span><span class="o">.</span><span class="n">stopMonitor</span><span class="p">(</span><span class="n">db_master</span><span class="p">)</span>
        <span class="n">db_master</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">node</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>

        <span class="c1"># Wait for commands to complete - important!.</span>
        <span class="c1"># Otherwise processes may not shut down.</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">node</span><span class="o">.</span><span class="n">waitOutput</span><span class="p">()</span>
        <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db_file</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">update_monitor_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Update monitoring statistics for all nodes in the simulation.</span>

<span class="sd">        Updates the `stat_samples` list with the latest counts of successful and total samples.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">stable_good_count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">stable_total_count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">dynamic_good_count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">dynamic_total_count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stub_net</span><span class="p">:</span>
            <span class="n">stable_good_count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
            <span class="n">stable_total_count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="o">+</span> <span class="n">stable_good_count</span>
            <span class="n">dynamic_good_count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
            <span class="n">dynamic_total_count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="o">+</span> <span class="n">dynamic_good_count</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="n">good</span><span class="p">,</span> <span class="n">total</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">update_monitor_stats</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">stable_node</span><span class="p">():</span>
                    <span class="n">stable_good_count</span> <span class="o">+=</span> <span class="n">good</span>
                    <span class="n">stable_total_count</span> <span class="o">+=</span> <span class="n">total</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">dynamic_good_count</span> <span class="o">+=</span> <span class="n">good</span>
                    <span class="n">dynamic_total_count</span> <span class="o">+=</span> <span class="n">total</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">stat_samples</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span> 
                                    <span class="n">stable_good_count</span><span class="p">,</span> <span class="n">stable_total_count</span><span class="p">,</span>
                                    <span class="n">dynamic_good_count</span><span class="p">,</span> <span class="n">dynamic_total_count</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stat_samples</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">200</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stat_samples</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_last_five_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">bool</span><span class="p">]]]:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Retrieve the last five monitoring samples for each node.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict[str, list[tuple[str, bool]]]: Dictionary mapping node names to their last five samples.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">bool</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">result</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">last_five_pings</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">sample_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_monitor_stats</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_node_status_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">stub_net</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">working_db</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">db_working</span> <span class="o">=</span> <span class="n">pmonitor</span><span class="o">.</span><span class="n">open_db</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">working_db</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">pmonitor</span><span class="o">.</span><span class="n">get_status_list</span><span class="p">(</span><span class="n">db_working</span><span class="p">)</span>
            <span class="n">db_working</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">get_stat_samples</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stat_samples</span>

    <span class="k">def</span> <span class="nf">get_topo_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">networkx</span><span class="o">.</span><span class="n">Graph</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>

    <span class="k">def</span> <span class="nf">get_ring_list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="s2">&quot;ring_list&quot;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">get_router_list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">str</span><span class="p">]]:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">torus_topo</span><span class="o">.</span><span class="n">satellites</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">):</span>
            <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
            <span class="n">ip</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ip&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ip</span> <span class="o">=</span> <span class="nb">format</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ip&quot;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ip</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">name</span><span class="p">,</span> <span class="n">ip</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">get_link_list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">str</span><span class="p">,</span><span class="nb">str</span><span class="p">]]:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">:</span>
            <span class="n">node1</span> <span class="o">=</span> <span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">node2</span> <span class="o">=</span> <span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">ip_str</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">ip</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">node1</span><span class="p">,</span> <span class="n">node2</span><span class="p">][</span><span class="s2">&quot;ip&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="n">ip_str</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">ip</span><span class="p">))</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">node1</span><span class="p">,</span> <span class="n">node2</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ip_str</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">get_link</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node1</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">node2</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">node1</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">node1</span><span class="si">}</span><span class="s2"> does not exist&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">node2</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">node2</span><span class="si">}</span><span class="s2"> does not exist&quot;</span>
        <span class="n">edge</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">adj</span><span class="p">[</span><span class="n">node1</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">node2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">edge</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;link </span><span class="si">{</span><span class="n">node1</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">node2</span><span class="si">}</span><span class="s2"> does not exist&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">node1</span><span class="p">,</span> <span class="n">node2</span><span class="p">,</span> <span class="n">edge</span><span class="p">[</span><span class="s2">&quot;ip&quot;</span><span class="p">][</span><span class="n">node1</span><span class="p">],</span> <span class="n">edge</span><span class="p">[</span><span class="s2">&quot;ip&quot;</span><span class="p">][</span><span class="n">node2</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">get_router</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> does not exist&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span> <span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ip&quot;</span><span class="p">),</span> <span class="s2">&quot;neighbors&quot;</span><span class="p">:</span> <span class="p">{}}</span>
        <span class="k">for</span> <span class="n">neighbor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">adj</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">edge</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">adj</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="n">neighbor</span><span class="p">]</span>
            <span class="n">result</span><span class="p">[</span><span class="s2">&quot;neighbors&quot;</span><span class="p">][</span><span class="n">neighbor</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;ip_local&quot;</span><span class="p">:</span> <span class="n">edge</span><span class="p">[</span><span class="s2">&quot;ip&quot;</span><span class="p">][</span><span class="n">name</span><span class="p">],</span>
                <span class="s2">&quot;ip_remote&quot;</span><span class="p">:</span> <span class="n">edge</span><span class="p">[</span><span class="s2">&quot;ip&quot;</span><span class="p">][</span><span class="n">neighbor</span><span class="p">],</span>
                <span class="s2">&quot;up&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_link_state</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">neighbor</span><span class="p">),</span>
                <span class="s2">&quot;intf_local&quot;</span><span class="p">:</span> <span class="n">edge</span><span class="p">[</span><span class="s2">&quot;intf&quot;</span><span class="p">][</span><span class="n">name</span><span class="p">],</span>
                <span class="s2">&quot;intf_remote&quot;</span><span class="p">:</span> <span class="n">edge</span><span class="p">[</span><span class="s2">&quot;intf&quot;</span><span class="p">][</span><span class="n">neighbor</span><span class="p">],</span>
            <span class="p">}</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">get_ground_stations</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">GroundStation</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ground_stations</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>

    <span class="k">def</span> <span class="nf">get_station</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ground_stations</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">set_link_state</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">node1</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">node2</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">state_up</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">node1</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">node1</span><span class="si">}</span><span class="s2"> does not exist&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">node2</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">node2</span><span class="si">}</span><span class="s2"> does not exist&quot;</span>
        <span class="n">adj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">adj</span><span class="p">[</span><span class="n">node1</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">node2</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">adj</span><span class="p">[</span><span class="n">node1</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">node2</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">node1</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">node2</span><span class="si">}</span><span class="s2"> does not exist&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_config_link_state</span><span class="p">(</span><span class="n">node1</span><span class="p">,</span> <span class="n">node2</span><span class="p">,</span> <span class="n">state_up</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">_config_link_state</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">node1</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">node2</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">state_up</span><span class="p">:</span> <span class="nb">bool</span> 
    <span class="p">):</span>
        <span class="n">state</span> <span class="o">=</span> <span class="s2">&quot;up&quot;</span> <span class="k">if</span> <span class="n">state_up</span> <span class="k">else</span> <span class="s2">&quot;down&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="n">configLinkStatus</span><span class="p">(</span><span class="n">node1</span><span class="p">,</span> <span class="n">node2</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_link_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node1</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">node2</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]:</span>
        <span class="n">n1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="n">getNodeByName</span><span class="p">(</span><span class="n">node1</span><span class="p">)</span>
        <span class="n">n2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="n">getNodeByName</span><span class="p">(</span><span class="n">node2</span><span class="p">)</span>
        <span class="n">links</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="n">linksBetween</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">links</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">link</span> <span class="o">=</span> <span class="n">links</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">link</span><span class="o">.</span><span class="n">intf1</span><span class="o">.</span><span class="n">isUp</span><span class="p">(),</span> <span class="n">link</span><span class="o">.</span><span class="n">intf2</span><span class="o">.</span><span class="n">isUp</span><span class="p">()</span>

        <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">set_station_uplinks</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">station_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">uplinks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">simapi</span><span class="o">.</span><span class="n">UpLink</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">station_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ground_stations</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="n">station</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ground_stations</span><span class="p">[</span><span class="n">station_name</span><span class="p">]</span>

        <span class="c1"># Determine which links should be removed</span>
        <span class="n">next_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">uplink</span><span class="o">.</span><span class="n">sat_node</span> <span class="k">for</span> <span class="n">uplink</span> <span class="ow">in</span> <span class="n">uplinks</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">sat_name</span> <span class="ow">in</span> <span class="n">station</span><span class="o">.</span><span class="n">sat_links</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">sat_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">next_list</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Remove uplink </span><span class="si">{</span><span class="n">station</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">sat_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">uplink</span> <span class="o">=</span> <span class="n">station</span><span class="o">.</span><span class="n">remove_uplink</span><span class="p">(</span><span class="n">sat_name</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_remove_link</span><span class="p">(</span>
                        <span class="n">station_name</span><span class="p">,</span> 
                        <span class="n">sat_name</span><span class="p">,</span> 
                        <span class="n">uplink</span><span class="o">.</span><span class="n">ip_pool_entry</span><span class="o">.</span><span class="n">network</span><span class="p">,</span>
                        <span class="n">uplink</span><span class="o">.</span><span class="n">ip_pool_entry</span><span class="o">.</span><span class="n">ip1</span><span class="p">)</span>

        <span class="c1"># Add any new links</span>
        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">uplinks</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">station</span><span class="o">.</span><span class="n">has_uplink</span><span class="p">(</span><span class="n">link</span><span class="o">.</span><span class="n">sat_node</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Add uplink </span><span class="si">{</span><span class="n">station</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">- </span><span class="si">{</span><span class="n">link</span><span class="o">.</span><span class="n">sat_node</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">uplink</span> <span class="o">=</span> <span class="n">station</span><span class="o">.</span><span class="n">add_uplink</span><span class="p">(</span><span class="n">link</span><span class="o">.</span><span class="n">sat_node</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">distance</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">uplink</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_create_uplink</span><span class="p">(</span>
                        <span class="n">station_name</span><span class="p">,</span>
                        <span class="n">link</span><span class="o">.</span><span class="n">sat_node</span><span class="p">,</span>
                        <span class="n">uplink</span><span class="o">.</span><span class="n">ip_pool_entry</span><span class="o">.</span><span class="n">network</span><span class="p">,</span>
                        <span class="n">uplink</span><span class="o">.</span><span class="n">ip_pool_entry</span><span class="o">.</span><span class="n">ip1</span><span class="p">,</span>
                        <span class="n">uplink</span><span class="o">.</span><span class="n">ip_pool_entry</span><span class="o">.</span><span class="n">ip2</span><span class="p">,</span>
                        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_default_route</span><span class="p">(</span><span class="n">station</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">_update_dns_for_uplink</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">station_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">sat_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">ip1</span><span class="p">:</span> <span class="n">ipaddress</span><span class="o">.</span><span class="n">IPv4Interface</span><span class="p">,</span> <span class="n">ip2</span><span class="p">:</span> <span class="n">ipaddress</span><span class="o">.</span><span class="n">IPv4Interface</span><span class="p">,</span> <span class="n">add</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Update DNS entries for a dynamic uplink.</span>

<span class="sd">        Args:</span>
<span class="sd">            station_name: Name of the ground station</span>
<span class="sd">            sat_name: Name of the satellite</span>
<span class="sd">            ip1: Ground station&#39;s interface IP</span>
<span class="sd">            ip2: Satellite&#39;s interface IP</span>
<span class="sd">            add: True to add entries, False to remove them</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1"># Create DNS entries for both ends of the uplink</span>
        <span class="n">dns_entries</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">format</span><span class="p">(</span><span class="n">ip1</span><span class="o">.</span><span class="n">ip</span><span class="p">)</span><span class="si">}</span><span class="se">\t</span><span class="si">{</span><span class="n">station_name</span><span class="si">}</span><span class="s2">-TO-</span><span class="si">{</span><span class="n">sat_name</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">station_name</span><span class="si">}</span><span class="s2">-uplink&quot;</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">format</span><span class="p">(</span><span class="n">ip2</span><span class="o">.</span><span class="n">ip</span><span class="p">)</span><span class="si">}</span><span class="se">\t</span><span class="si">{</span><span class="n">sat_name</span><span class="si">}</span><span class="s2">-TO-</span><span class="si">{</span><span class="n">station_name</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">sat_name</span><span class="si">}</span><span class="s2">-downlink&quot;</span>
        <span class="p">]</span>

        <span class="c1"># Update hosts file in each network namespace</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="n">hosts</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">add</span><span class="p">:</span>
                <span class="c1"># Add new entries</span>
                <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">dns_entries</span><span class="p">:</span>
                    <span class="n">node</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;echo &quot;</span><span class="si">{</span><span class="n">entry</span><span class="si">}</span><span class="s1">&quot; &gt;&gt; /etc/netns/</span><span class="si">{</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">/hosts&#39;</span><span class="p">)</span>
                    <span class="n">node</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;echo &quot;</span><span class="si">{</span><span class="n">entry</span><span class="si">}</span><span class="s1">&quot; &gt;&gt; /etc/hosts&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Remove entries</span>
                <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">dns_entries</span><span class="p">:</span>
                    <span class="n">node</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;sed -i &quot;/</span><span class="si">{</span><span class="n">entry</span><span class="si">}</span><span class="s1">/d&quot; /etc/netns/</span><span class="si">{</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">/hosts&#39;</span><span class="p">)</span>
                    <span class="n">node</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;sed -i &quot;/</span><span class="si">{</span><span class="n">entry</span><span class="si">}</span><span class="s1">/d&quot; /etc/hosts&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_create_uplink</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">station_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">sat_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">ip_nw</span><span class="p">:</span> <span class="n">ipaddress</span><span class="o">.</span><span class="n">IPv4Network</span><span class="p">,</span>
        <span class="n">ip1</span><span class="p">:</span> <span class="n">ipaddress</span><span class="o">.</span><span class="n">IPv4Interface</span><span class="p">,</span>
        <span class="n">ip2</span><span class="p">:</span> <span class="n">ipaddress</span><span class="o">.</span><span class="n">IPv4Interface</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="c1"># Create the link</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="n">addLink</span><span class="p">(</span>
            <span class="n">station_name</span><span class="p">,</span> <span class="n">sat_name</span><span class="p">,</span> 
            <span class="n">params1</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="nb">format</span><span class="p">(</span><span class="n">ip1</span><span class="p">),</span> <span class="s2">&quot;delay&quot;</span><span class="p">:</span> <span class="s2">&quot;1ms&quot;</span><span class="p">},</span> 
            <span class="n">params2</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="nb">format</span><span class="p">(</span><span class="n">ip2</span><span class="p">),</span> <span class="s2">&quot;delay&quot;</span><span class="p">:</span> <span class="s2">&quot;1ms&quot;</span><span class="p">},</span>
            <span class="bp">cls</span><span class="o">=</span><span class="n">mininet</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">TCLink</span><span class="p">,</span> 
        <span class="p">)</span>

        <span class="n">station</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ground_stations</span><span class="p">[</span><span class="n">station_name</span><span class="p">]</span>
        <span class="n">frr_router</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">routers</span><span class="p">[</span><span class="n">sat_name</span><span class="p">]</span>

        <span class="c1"># Configure static route and OSPF</span>
        <span class="n">frr_router</span><span class="o">.</span><span class="n">config_frr</span><span class="p">(</span><span class="s2">&quot;staticd&quot;</span><span class="p">,</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;ip route </span><span class="si">{</span><span class="n">station</span><span class="o">.</span><span class="n">defaultIP</span><span class="p">()</span><span class="si">}</span><span class="s2">/32 </span><span class="si">{</span><span class="nb">format</span><span class="p">(</span><span class="n">ip1</span><span class="o">.</span><span class="n">ip</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">])</span>
        <span class="n">ospf_commands</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;router ospf&quot;</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;network </span><span class="si">{</span><span class="nb">format</span><span class="p">(</span><span class="n">ip_nw</span><span class="p">)</span><span class="si">}</span><span class="s2"> area 0&quot;</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;network </span><span class="si">{</span><span class="n">station</span><span class="o">.</span><span class="n">defaultIP</span><span class="p">()</span><span class="si">}</span><span class="s2">/32 area 0&quot;</span><span class="p">,</span>
            <span class="s2">&quot;exit&quot;</span>
        <span class="p">]</span>
        <span class="n">frr_router</span><span class="o">.</span><span class="n">config_frr</span><span class="p">(</span><span class="s2">&quot;ospfd&quot;</span><span class="p">,</span> <span class="n">ospf_commands</span><span class="p">)</span>

        <span class="c1"># Add DNS entries for the uplink</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_dns_for_uplink</span><span class="p">(</span><span class="n">station_name</span><span class="p">,</span> <span class="n">sat_name</span><span class="p">,</span> <span class="n">ip1</span><span class="p">,</span> <span class="n">ip2</span><span class="p">,</span> <span class="n">add</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Add default route on ground station</span>
        <span class="n">station_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="n">getNodeByName</span><span class="p">(</span><span class="n">station_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">station_node</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">route</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;via </span><span class="si">{</span><span class="nb">format</span><span class="p">(</span><span class="n">ip2</span><span class="o">.</span><span class="n">ip</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">station_node</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ip route add default </span><span class="si">{</span><span class="n">route</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_remove_link</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">station_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">sat_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">ip_nw</span><span class="p">:</span> <span class="n">ipaddress</span><span class="o">.</span><span class="n">IPv4Network</span><span class="p">,</span> <span class="n">ip</span><span class="p">:</span> <span class="n">ipaddress</span><span class="o">.</span><span class="n">IPv4Interface</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">station_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="n">getNodeByName</span><span class="p">(</span><span class="n">station_name</span><span class="p">)</span>
        <span class="n">sat_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="n">getNodeByName</span><span class="p">(</span><span class="n">sat_name</span><span class="p">)</span>

        <span class="c1"># Remove DNS entries before removing the link</span>
        <span class="n">uplink</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ground_stations</span><span class="p">[</span><span class="n">station_name</span><span class="p">]</span><span class="o">.</span><span class="n">uplinks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Get the uplink to get IPs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_dns_for_uplink</span><span class="p">(</span>
            <span class="n">station_name</span><span class="p">,</span> 
            <span class="n">sat_name</span><span class="p">,</span> 
            <span class="n">uplink</span><span class="o">.</span><span class="n">ip_pool_entry</span><span class="o">.</span><span class="n">ip1</span><span class="p">,</span> 
            <span class="n">uplink</span><span class="o">.</span><span class="n">ip_pool_entry</span><span class="o">.</span><span class="n">ip2</span><span class="p">,</span> 
            <span class="n">add</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>

        <span class="c1"># Remove static route</span>
        <span class="n">station</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ground_stations</span><span class="p">[</span><span class="n">station_name</span><span class="p">]</span>
        <span class="n">frr_router</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">routers</span><span class="p">[</span><span class="n">sat_name</span><span class="p">]</span>
        <span class="n">frr_router</span><span class="o">.</span><span class="n">config_frr</span><span class="p">(</span><span class="s2">&quot;staticd&quot;</span><span class="p">,</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;no ip route </span><span class="si">{</span><span class="n">station</span><span class="o">.</span><span class="n">defaultIP</span><span class="p">()</span><span class="si">}</span><span class="s2">/32 </span><span class="si">{</span><span class="nb">format</span><span class="p">(</span><span class="n">ip</span><span class="o">.</span><span class="n">ip</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="n">delLinkBetween</span><span class="p">(</span><span class="n">station_node</span><span class="p">,</span> <span class="n">sat_node</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_update_default_route</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">station</span><span class="p">:</span> <span class="n">GroundStation</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">closest_uplink</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># Find closest uplink</span>
        <span class="k">for</span> <span class="n">uplink</span> <span class="ow">in</span> <span class="n">station</span><span class="o">.</span><span class="n">uplinks</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">closest_uplink</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">closest_uplink</span> <span class="o">=</span> <span class="n">uplink</span>
            <span class="k">elif</span> <span class="n">closest_uplink</span><span class="o">.</span><span class="n">distance</span> <span class="o">&lt;</span> <span class="n">uplink</span><span class="o">.</span><span class="n">distance</span><span class="p">:</span>
                <span class="n">closest_uplink</span> <span class="o">=</span> <span class="n">uplink</span>

        <span class="c1"># If the closest has changed, update the default route</span>
        <span class="k">if</span> <span class="n">closest_uplink</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">closest_uplink</span><span class="o">.</span><span class="n">default</span><span class="p">:</span>
            <span class="c1"># Clear current default</span>
            <span class="k">for</span> <span class="n">uplink</span> <span class="ow">in</span> <span class="n">station</span><span class="o">.</span><span class="n">uplinks</span><span class="p">:</span>
                <span class="n">uplink</span><span class="o">.</span><span class="n">default</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="c1"># Mark new default and set</span>
            <span class="n">closest_uplink</span><span class="o">.</span><span class="n">default</span> <span class="o">=</span> <span class="kc">True</span> 
            <span class="n">station_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="n">getNodeByName</span><span class="p">(</span><span class="n">station</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">route</span> <span class="o">=</span> <span class="s2">&quot;via </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">format</span><span class="p">(</span><span class="n">closest_uplink</span><span class="o">.</span><span class="n">ip_pool_entry</span><span class="o">.</span><span class="n">ip2</span><span class="o">.</span><span class="n">ip</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;set default route for </span><span class="si">{</span><span class="n">station</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">route</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">station_node</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">station_node</span><span class="o">.</span><span class="n">setDefaultRoute</span><span class="p">(</span><span class="n">route</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="emulation.mnet.frr_topo.FrrSimRuntime.get_last_five_stats" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_last_five_stats</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Retrieve the last five monitoring samples for each node.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>dict[str, list[tuple[str, bool]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict[str, list[tuple[str, bool]]]: Dictionary mapping node names to their last five samples.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>emulation/mnet/frr_topo.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_last_five_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">bool</span><span class="p">]]]:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Retrieve the last five monitoring samples for each node.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict[str, list[tuple[str, bool]]]: Dictionary mapping node names to their last five samples.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">bool</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">result</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">last_five_pings</span>
    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="emulation.mnet.frr_topo.FrrSimRuntime.start_routers" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">start_routers</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Start all routers and monitoring processes in the simulation.</p>
<p>Populates the monitoring database with target information and launches
monitoring threads for dynamic and stable nodes.</p>

            <details class="quote">
              <summary>Source code in <code>emulation/mnet/frr_topo.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">start_routers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Start all routers and monitoring processes in the simulation.</span>

<span class="sd">    Populates the monitoring database with target information and launches</span>
<span class="sd">    monitoring threads for dynamic and stable nodes.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="c1"># Populate master db file</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># Stable targets - to monitor</span>
    <span class="k">for</span> <span class="n">router</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">routers</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">router</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">router</span><span class="o">.</span><span class="n">defaultIP</span><span class="p">(),</span> <span class="n">router</span><span class="o">.</span><span class="n">stable_node</span><span class="p">()))</span>
    <span class="c1"># Not stable targets - don&#39;t monitor</span>
    <span class="k">for</span> <span class="n">station</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ground_stations</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">station</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">station</span><span class="o">.</span><span class="n">defaultIP</span><span class="p">(),</span> <span class="n">station</span><span class="o">.</span><span class="n">stable_node</span><span class="p">()))</span>
    <span class="n">pmonitor</span><span class="o">.</span><span class="n">init_targets</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db_file</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

    <span class="c1"># Start all nodes</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">node</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">net</span><span class="p">)</span>

    <span class="c1"># Wait for start to complete.</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">node</span><span class="o">.</span><span class="n">waitOutput</span><span class="p">()</span>

    <span class="c1"># Start monitoring on all nodes</span>
    <span class="n">db_master</span> <span class="o">=</span> <span class="n">pmonitor</span><span class="o">.</span><span class="n">open_db</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db_file</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="c1"># Start monitor if node is not considered always reachable</span>
        <span class="c1"># or we are running monitoring from the stable nodes.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stable_monitor</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">node</span><span class="o">.</span><span class="n">stable_node</span><span class="p">():</span>
            <span class="n">node</span><span class="o">.</span><span class="n">startMonitor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db_file</span><span class="p">,</span> <span class="n">db_master</span><span class="p">)</span>
    <span class="n">db_master</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="c1"># Wait for monitoring to start</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stable_monitor</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">node</span><span class="o">.</span><span class="n">stable_node</span><span class="p">():</span>
            <span class="n">node</span><span class="o">.</span><span class="n">waitOutput</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="emulation.mnet.frr_topo.FrrSimRuntime.stop_routers" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">stop_routers</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Stop all routers and monitoring processes in the simulation.</p>
<p>Performs cleanup of monitoring databases and network resources.</p>

            <details class="quote">
              <summary>Source code in <code>emulation/mnet/frr_topo.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">stop_routers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Stop all routers and monitoring processes in the simulation.</span>

<span class="sd">    Performs cleanup of monitoring databases and network resources.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="c1"># Stop monitor on all nodes</span>
    <span class="n">db_master</span> <span class="o">=</span> <span class="n">pmonitor</span><span class="o">.</span><span class="n">open_db</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db_file</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">node</span><span class="o">.</span><span class="n">stopMonitor</span><span class="p">(</span><span class="n">db_master</span><span class="p">)</span>
    <span class="n">db_master</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">node</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>

    <span class="c1"># Wait for commands to complete - important!.</span>
    <span class="c1"># Otherwise processes may not shut down.</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">node</span><span class="o">.</span><span class="n">waitOutput</span><span class="p">()</span>
    <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db_file</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="emulation.mnet.frr_topo.FrrSimRuntime.update_monitor_stats" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_monitor_stats</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Update monitoring statistics for all nodes in the simulation.</p>
<p>Updates the <code>stat_samples</code> list with the latest counts of successful and total samples.</p>

            <details class="quote">
              <summary>Source code in <code>emulation/mnet/frr_topo.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">update_monitor_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Update monitoring statistics for all nodes in the simulation.</span>

<span class="sd">    Updates the `stat_samples` list with the latest counts of successful and total samples.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">stable_good_count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">stable_total_count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">dynamic_good_count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">dynamic_total_count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stub_net</span><span class="p">:</span>
        <span class="n">stable_good_count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
        <span class="n">stable_total_count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="o">+</span> <span class="n">stable_good_count</span>
        <span class="n">dynamic_good_count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
        <span class="n">dynamic_total_count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="o">+</span> <span class="n">dynamic_good_count</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">good</span><span class="p">,</span> <span class="n">total</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">update_monitor_stats</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">stable_node</span><span class="p">():</span>
                <span class="n">stable_good_count</span> <span class="o">+=</span> <span class="n">good</span>
                <span class="n">stable_total_count</span> <span class="o">+=</span> <span class="n">total</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dynamic_good_count</span> <span class="o">+=</span> <span class="n">good</span>
                <span class="n">dynamic_total_count</span> <span class="o">+=</span> <span class="n">total</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">stat_samples</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span> 
                                <span class="n">stable_good_count</span><span class="p">,</span> <span class="n">stable_total_count</span><span class="p">,</span>
                                <span class="n">dynamic_good_count</span><span class="p">,</span> <span class="n">dynamic_total_count</span><span class="p">))</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stat_samples</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">200</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stat_samples</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="emulation.mnet.frr_topo.GroundStation" class="doc doc-heading">
            <code>GroundStation</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="emulation.mnet.frr_topo.MNetNodeWrap" href="#emulation.mnet.frr_topo.MNetNodeWrap">MNetNodeWrap</a></code></p>


        <p>State for a Ground Station</p>
<p>Tracks established uplinks to satellites.
Not a mininet node.</p>






              <details class="quote">
                <summary>Source code in <code>emulation/mnet/frr_topo.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">GroundStation</span><span class="p">(</span><span class="n">MNetNodeWrap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    State for a Ground Station</span>

<span class="sd">    Tracks established uplinks to satellites.</span>
<span class="sd">    Not a mininet node.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">default_ip</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">uplinks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">default_ip</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">uplinks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Uplink</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ip_pool</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">IPPoolEntry</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">uplinks</span><span class="p">:</span>
            <span class="n">entry</span> <span class="o">=</span> <span class="n">IPPoolEntry</span><span class="p">(</span><span class="n">network</span><span class="o">=</span><span class="n">link</span><span class="p">[</span><span class="s2">&quot;nw&quot;</span><span class="p">],</span> <span class="n">ip1</span><span class="o">=</span><span class="n">link</span><span class="p">[</span><span class="s2">&quot;ip1&quot;</span><span class="p">],</span> <span class="n">ip2</span><span class="o">=</span><span class="n">link</span><span class="p">[</span><span class="s2">&quot;ip2&quot;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ip_pool</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">stable_node</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Indicate that the ground station is not expected to be always reachable.</span>

<span class="sd">        Overrides:</span>
<span class="sd">            `MNetNodeWrap.stable_node`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: Always returns False.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">has_uplink</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sat_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">uplink</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">uplinks</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">uplink</span><span class="o">.</span><span class="n">sat_name</span> <span class="o">==</span> <span class="n">sat_name</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">sat_links</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Return a list of satellite names to which we have uplinks</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">uplink</span><span class="o">.</span><span class="n">sat_name</span> <span class="k">for</span> <span class="n">uplink</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">uplinks</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_get_pool_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">IPPoolEntry</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ip_pool</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">entry</span><span class="o">.</span><span class="n">used</span><span class="p">:</span>
                <span class="n">entry</span><span class="o">.</span><span class="n">used</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">return</span> <span class="n">entry</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">add_uplink</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sat_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">distance</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Uplink</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Add an uplink to a satellite.</span>

<span class="sd">        Args:</span>
<span class="sd">            sat_name (str): Name of the satellite.</span>
<span class="sd">            distance (int): Distance to the satellite.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Uplink | None: The created uplink, or None if no available IP pool entry.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">pool_entry</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_pool_entry</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">pool_entry</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">uplink</span> <span class="o">=</span> <span class="n">Uplink</span><span class="p">(</span><span class="n">sat_name</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">pool_entry</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">uplinks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">uplink</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">uplink</span>

    <span class="k">def</span> <span class="nf">remove_uplink</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sat_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Uplink</span><span class="o">|</span><span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Remove an uplink to a satellite.</span>

<span class="sd">        Args:</span>
<span class="sd">            sat_name (str): Name of the satellite.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Uplink | None: The removed uplink, or None if the uplink doesn&#39;t exist.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">uplinks</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">sat_name</span> <span class="o">==</span> <span class="n">sat_name</span><span class="p">:</span>
                <span class="n">entry</span><span class="o">.</span><span class="n">ip_pool_entry</span><span class="o">.</span><span class="n">used</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">uplinks</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">entry</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="emulation.mnet.frr_topo.GroundStation.add_uplink" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_uplink</span><span class="p">(</span><span class="n">sat_name</span><span class="p">,</span> <span class="n">distance</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Add an uplink to a satellite.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>sat_name</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the satellite.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>distance</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Distance to the satellite.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="emulation.mnet.frr_topo.Uplink">Uplink</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Uplink | None: The created uplink, or None if no available IP pool entry.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>emulation/mnet/frr_topo.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_uplink</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sat_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">distance</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Uplink</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Add an uplink to a satellite.</span>

<span class="sd">    Args:</span>
<span class="sd">        sat_name (str): Name of the satellite.</span>
<span class="sd">        distance (int): Distance to the satellite.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Uplink | None: The created uplink, or None if no available IP pool entry.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">pool_entry</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_pool_entry</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">pool_entry</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="n">uplink</span> <span class="o">=</span> <span class="n">Uplink</span><span class="p">(</span><span class="n">sat_name</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">pool_entry</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">uplinks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">uplink</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">uplink</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="emulation.mnet.frr_topo.GroundStation.remove_uplink" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">remove_uplink</span><span class="p">(</span><span class="n">sat_name</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Remove an uplink to a satellite.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>sat_name</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the satellite.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="emulation.mnet.frr_topo.Uplink">Uplink</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Uplink | None: The removed uplink, or None if the uplink doesn't exist.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>emulation/mnet/frr_topo.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">remove_uplink</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sat_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Uplink</span><span class="o">|</span><span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Remove an uplink to a satellite.</span>

<span class="sd">    Args:</span>
<span class="sd">        sat_name (str): Name of the satellite.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Uplink | None: The removed uplink, or None if the uplink doesn&#39;t exist.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">uplinks</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">sat_name</span> <span class="o">==</span> <span class="n">sat_name</span><span class="p">:</span>
            <span class="n">entry</span><span class="o">.</span><span class="n">ip_pool_entry</span><span class="o">.</span><span class="n">used</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">uplinks</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">entry</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="emulation.mnet.frr_topo.GroundStation.sat_links" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sat_links</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return a list of satellite names to which we have uplinks</p>

            <details class="quote">
              <summary>Source code in <code>emulation/mnet/frr_topo.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">sat_links</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Return a list of satellite names to which we have uplinks</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">uplink</span><span class="o">.</span><span class="n">sat_name</span> <span class="k">for</span> <span class="n">uplink</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">uplinks</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="emulation.mnet.frr_topo.GroundStation.stable_node" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">stable_node</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Indicate that the ground station is not expected to be always reachable.</p>


<details class="overrides" open>
  <summary>Overrides</summary>
  <p><code>MNetNodeWrap.stable_node</code>.</p>
</details>

    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Always returns False.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>emulation/mnet/frr_topo.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">stable_node</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Indicate that the ground station is not expected to be always reachable.</span>

<span class="sd">    Overrides:</span>
<span class="sd">        `MNetNodeWrap.stable_node`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: Always returns False.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="emulation.mnet.frr_topo.MNetNodeWrap" class="doc doc-heading">
            <code>MNetNodeWrap</code>


</h2>


    <div class="doc doc-contents ">


        






              <details class="quote">
                <summary>Source code in <code>emulation/mnet/frr_topo.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">MNetNodeWrap</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span> <span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">default_ip</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default_ip</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">default_ip</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">node</span> <span class="p">:</span> <span class="n">mininet</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">Node</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">fd</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">working_db</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mkstemp</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="s2">&quot;.sqlite&quot;</span><span class="p">)</span>
        <span class="nb">open</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> db file </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">working_db</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_five_pings</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">sendCmd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span> <span class="p">:</span><span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Send a command to the node for execution.</span>

<span class="sd">        Args:</span>
<span class="sd">            command (str): The command to execute on the node.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">node</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">sendCmd</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">net</span><span class="p">:</span> <span class="n">mininet</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="n">Mininet</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Initialize the Mininet node after the network has started.</span>

<span class="sd">        Args:</span>
<span class="sd">            net (mininet.net.Mininet): The Mininet network instance.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">node</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">getNodeByName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">waitOutput</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">node</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">waitOutput</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Perform cleanup operations before stopping the node.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">startMonitor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">db_master_file</span><span class="p">,</span> <span class="n">db_master</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Start monitoring for the node.</span>

<span class="sd">        Args:</span>
<span class="sd">            db_master_file (str): Path to the master database file.</span>
<span class="sd">            db_master (sqlite3.Connection): Open connection to the master database.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;start monitor </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">defaultIP</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sendCmd</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;python3 -m emulation.mnet.pmonitor monitor &#39;</span><span class="si">{</span><span class="n">db_master_file</span><span class="si">}</span><span class="s2">&#39; &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">working_db</span><span class="si">}</span><span class="s2">&#39; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">defaultIP</span><span class="p">()</span><span class="si">}</span><span class="s2"> &gt;&gt; /dev/null 2&gt;&amp;1  &amp;&quot;</span>
        <span class="p">)</span>
        <span class="n">pmonitor</span><span class="o">.</span><span class="n">set_running</span><span class="p">(</span><span class="n">db_master</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">defaultIP</span><span class="p">(),</span> <span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">stopMonitor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">db_master</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Stop monitoring for the node and clean up associated resources.</span>

<span class="sd">        Args:</span>
<span class="sd">            db_master (sqlite3.Connection): Open connection to the master database.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">pmonitor</span><span class="o">.</span><span class="n">set_can_run</span><span class="p">(</span><span class="n">db_master</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">defaultIP</span><span class="p">(),</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">working_db</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">update_monitor_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Update the monitoring statistics for the node.</span>

<span class="sd">        Returns:</span>
<span class="sd">            tuple[int, int]: Counts of successful and total samples.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1"># Only get stats if DB is being used</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">working_db</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">db</span> <span class="o">=</span> <span class="n">pmonitor</span><span class="o">.</span><span class="n">open_db</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">working_db</span><span class="p">)</span>
            <span class="n">good</span><span class="p">,</span> <span class="n">total</span> <span class="o">=</span> <span class="n">pmonitor</span><span class="o">.</span><span class="n">get_status_count</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stable_node</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">last_five_pings</span> <span class="o">=</span> <span class="n">pmonitor</span><span class="o">.</span><span class="n">get_last_five</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
            <span class="n">db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">good</span><span class="p">,</span> <span class="n">total</span>

        <span class="c1"># Return default values when DB is not in use or empty</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">defaultIP</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Get the default IP address of the node&#39;s interface.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The default IP address.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">node</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">defaultIntf</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">defaultIntf</span><span class="p">()</span><span class="o">.</span><span class="n">ip</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_ip</span>

    <span class="k">def</span> <span class="nf">stable_node</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Check if the node is expected to always be reachable.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: True if the node is stable, False otherwise.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="emulation.mnet.frr_topo.MNetNodeWrap.defaultIP" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">defaultIP</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get the default IP address of the node's interface.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The default IP address.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>emulation/mnet/frr_topo.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">defaultIP</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Get the default IP address of the node&#39;s interface.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The default IP address.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">node</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">defaultIntf</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">defaultIntf</span><span class="p">()</span><span class="o">.</span><span class="n">ip</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_ip</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="emulation.mnet.frr_topo.MNetNodeWrap.sendCmd" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sendCmd</span><span class="p">(</span><span class="n">command</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Send a command to the node for execution.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>command</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The command to execute on the node.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>emulation/mnet/frr_topo.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">sendCmd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span> <span class="p">:</span><span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Send a command to the node for execution.</span>

<span class="sd">    Args:</span>
<span class="sd">        command (str): The command to execute on the node.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">node</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">sendCmd</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="emulation.mnet.frr_topo.MNetNodeWrap.stable_node" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">stable_node</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Check if the node is expected to always be reachable.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the node is stable, False otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>emulation/mnet/frr_topo.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">stable_node</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Check if the node is expected to always be reachable.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True if the node is stable, False otherwise.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="emulation.mnet.frr_topo.MNetNodeWrap.start" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">start</span><span class="p">(</span><span class="n">net</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Initialize the Mininet node after the network has started.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>net</code>
            </td>
            <td>
                  <code><span title="mininet.net.Mininet">Mininet</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Mininet network instance.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>emulation/mnet/frr_topo.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">net</span><span class="p">:</span> <span class="n">mininet</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="n">Mininet</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Initialize the Mininet node after the network has started.</span>

<span class="sd">    Args:</span>
<span class="sd">        net (mininet.net.Mininet): The Mininet network instance.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">node</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">getNodeByName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="emulation.mnet.frr_topo.MNetNodeWrap.startMonitor" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">startMonitor</span><span class="p">(</span><span class="n">db_master_file</span><span class="p">,</span> <span class="n">db_master</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Start monitoring for the node.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>db_master_file</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the master database file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>db_master</code>
            </td>
            <td>
                  <code><span title="sqlite3.Connection">Connection</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Open connection to the master database.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>emulation/mnet/frr_topo.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">startMonitor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">db_master_file</span><span class="p">,</span> <span class="n">db_master</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Start monitoring for the node.</span>

<span class="sd">    Args:</span>
<span class="sd">        db_master_file (str): Path to the master database file.</span>
<span class="sd">        db_master (sqlite3.Connection): Open connection to the master database.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;start monitor </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">defaultIP</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sendCmd</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;python3 -m emulation.mnet.pmonitor monitor &#39;</span><span class="si">{</span><span class="n">db_master_file</span><span class="si">}</span><span class="s2">&#39; &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">working_db</span><span class="si">}</span><span class="s2">&#39; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">defaultIP</span><span class="p">()</span><span class="si">}</span><span class="s2"> &gt;&gt; /dev/null 2&gt;&amp;1  &amp;&quot;</span>
    <span class="p">)</span>
    <span class="n">pmonitor</span><span class="o">.</span><span class="n">set_running</span><span class="p">(</span><span class="n">db_master</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">defaultIP</span><span class="p">(),</span> <span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="emulation.mnet.frr_topo.MNetNodeWrap.stop" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">stop</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Perform cleanup operations before stopping the node.</p>

            <details class="quote">
              <summary>Source code in <code>emulation/mnet/frr_topo.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Perform cleanup operations before stopping the node.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="emulation.mnet.frr_topo.MNetNodeWrap.stopMonitor" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">stopMonitor</span><span class="p">(</span><span class="n">db_master</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Stop monitoring for the node and clean up associated resources.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>db_master</code>
            </td>
            <td>
                  <code><span title="sqlite3.Connection">Connection</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Open connection to the master database.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>emulation/mnet/frr_topo.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">stopMonitor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">db_master</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Stop monitoring for the node and clean up associated resources.</span>

<span class="sd">    Args:</span>
<span class="sd">        db_master (sqlite3.Connection): Open connection to the master database.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">pmonitor</span><span class="o">.</span><span class="n">set_can_run</span><span class="p">(</span><span class="n">db_master</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">defaultIP</span><span class="p">(),</span> <span class="kc">False</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">working_db</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="emulation.mnet.frr_topo.MNetNodeWrap.update_monitor_stats" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_monitor_stats</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Update the monitoring statistics for the node.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[int, int]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tuple[int, int]: Counts of successful and total samples.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>emulation/mnet/frr_topo.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">update_monitor_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Update the monitoring statistics for the node.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple[int, int]: Counts of successful and total samples.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># Only get stats if DB is being used</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">working_db</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">db</span> <span class="o">=</span> <span class="n">pmonitor</span><span class="o">.</span><span class="n">open_db</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">working_db</span><span class="p">)</span>
        <span class="n">good</span><span class="p">,</span> <span class="n">total</span> <span class="o">=</span> <span class="n">pmonitor</span><span class="o">.</span><span class="n">get_status_count</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stable_node</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_five_pings</span> <span class="o">=</span> <span class="n">pmonitor</span><span class="o">.</span><span class="n">get_last_five</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
        <span class="n">db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">good</span><span class="p">,</span> <span class="n">total</span>

    <span class="c1"># Return default values when DB is not in use or empty</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="emulation.mnet.frr_topo.NetxTopo" class="doc doc-heading">
            <code>NetxTopo</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="mininet.topo.Topo">Topo</span></code></p>


        <p>Mininet topology object used to build the virtual network.</p>






              <details class="quote">
                <summary>Source code in <code>emulation/mnet/frr_topo.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">NetxTopo</span><span class="p">(</span><span class="n">mininet</span><span class="o">.</span><span class="n">topo</span><span class="o">.</span><span class="n">Topo</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Mininet topology object used to build the virtual network.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="p">:</span> <span class="n">networkx</span><span class="o">.</span><span class="n">Graph</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="o">=</span> <span class="n">graph</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">routers</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">FrrRouter</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ground_stations</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">GroundStation</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Construct the Mininet topology based on the `networkx.Graph` structure.</span>

<span class="sd">        Creates:</span>
<span class="sd">            - Mininet hosts for routers and ground stations.</span>
<span class="sd">            - Links between nodes based on the graph edges.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1"># Create routers</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">torus_topo</span><span class="o">.</span><span class="n">satellites</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">):</span>
            <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
            <span class="n">ip</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ip&quot;</span><span class="p">)</span>
            <span class="n">ip_intf</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">ip_addr</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">ip</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ip_intf</span> <span class="o">=</span> <span class="nb">format</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span>
                <span class="n">ip_addr</span> <span class="o">=</span> <span class="nb">format</span><span class="p">(</span><span class="n">ip</span><span class="o">.</span><span class="n">ip</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">addHost</span><span class="p">(</span>
                <span class="n">name</span><span class="p">,</span>
                <span class="bp">cls</span><span class="o">=</span><span class="n">RouteNode</span><span class="p">,</span>
                <span class="n">ip</span><span class="o">=</span><span class="n">ip_intf</span><span class="p">)</span>

            <span class="n">frr_router</span><span class="p">:</span> <span class="n">FrrRouter</span> <span class="o">=</span> <span class="n">FrrRouter</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">ip_addr</span><span class="p">)</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">routers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">frr_router</span><span class="p">)</span>
            <span class="n">frr_router</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span>
                <span class="n">ospf</span><span class="o">=</span><span class="n">node</span><span class="p">[</span><span class="s2">&quot;ospf&quot;</span><span class="p">],</span>
                <span class="n">vtysh</span><span class="o">=</span><span class="n">node</span><span class="p">[</span><span class="s2">&quot;vtysh&quot;</span><span class="p">],</span>
                <span class="n">daemons</span><span class="o">=</span><span class="n">node</span><span class="p">[</span><span class="s2">&quot;daemons&quot;</span><span class="p">]</span>
            <span class="p">)</span>

        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">torus_topo</span><span class="o">.</span><span class="n">ground_stations</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">):</span>
            <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
            <span class="n">ip</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ip&quot;</span><span class="p">)</span>
            <span class="n">ip_intf</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">ip_addr</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">ip</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ip_intf</span> <span class="o">=</span> <span class="nb">format</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span>
                <span class="n">ip_addr</span> <span class="o">=</span> <span class="nb">format</span><span class="p">(</span><span class="n">ip</span><span class="o">.</span><span class="n">ip</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">addHost</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="n">RouteNode</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="n">ip_intf</span><span class="p">)</span>

            <span class="n">station</span> <span class="o">=</span> <span class="n">GroundStation</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">ip_addr</span><span class="p">,</span> <span class="n">node</span><span class="p">[</span><span class="s2">&quot;uplinks&quot;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ground_stations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">station</span><span class="p">)</span>

        <span class="c1"># Create links between routers</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">edge</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">router1</span> <span class="o">=</span> <span class="n">name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">router2</span> <span class="o">=</span> <span class="n">name</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

            <span class="c1"># Handle incomplete edged</span>
            <span class="k">if</span> <span class="n">edge</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ip&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">addLink</span><span class="p">(</span><span class="n">router1</span><span class="p">,</span> <span class="n">router2</span><span class="p">)</span>
                <span class="k">return</span>

            <span class="n">ip1</span> <span class="o">=</span> <span class="n">edge</span><span class="p">[</span><span class="s2">&quot;ip&quot;</span><span class="p">][</span><span class="n">router1</span><span class="p">]</span>
            <span class="n">intf1</span> <span class="o">=</span> <span class="n">edge</span><span class="p">[</span><span class="s2">&quot;intf&quot;</span><span class="p">][</span><span class="n">router1</span><span class="p">]</span>

            <span class="n">ip2</span> <span class="o">=</span> <span class="n">edge</span><span class="p">[</span><span class="s2">&quot;ip&quot;</span><span class="p">][</span><span class="n">router2</span><span class="p">]</span>
            <span class="n">intf2</span> <span class="o">=</span> <span class="n">edge</span><span class="p">[</span><span class="s2">&quot;intf&quot;</span><span class="p">][</span><span class="n">router2</span><span class="p">]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">addLink</span><span class="p">(</span>
                <span class="n">router1</span><span class="p">,</span>
                <span class="n">router2</span><span class="p">,</span>
                <span class="n">intfName1</span><span class="o">=</span><span class="n">intf1</span><span class="p">,</span>
                <span class="n">intfName2</span><span class="o">=</span><span class="n">intf2</span><span class="p">,</span>
                <span class="n">params1</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="nb">format</span><span class="p">(</span><span class="n">ip1</span><span class="p">),</span> <span class="s2">&quot;delay&quot;</span><span class="p">:</span> <span class="s2">&quot;1ms&quot;</span><span class="p">},</span>
                <span class="n">params2</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="nb">format</span><span class="p">(</span><span class="n">ip2</span><span class="p">),</span> <span class="s2">&quot;delay&quot;</span><span class="p">:</span> <span class="s2">&quot;1ms&quot;</span><span class="p">},</span>
                <span class="bp">cls</span><span class="o">=</span><span class="n">mininet</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">TCLink</span><span class="p">,</span> 
            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="emulation.mnet.frr_topo.NetxTopo.build" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">build</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Construct the Mininet topology based on the <code>networkx.Graph</code> structure.</p>


<details class="creates" open>
  <summary>Creates</summary>
  <ul>
<li>Mininet hosts for routers and ground stations.</li>
<li>Links between nodes based on the graph edges.</li>
</ul>
</details>
            <details class="quote">
              <summary>Source code in <code>emulation/mnet/frr_topo.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Construct the Mininet topology based on the `networkx.Graph` structure.</span>

<span class="sd">    Creates:</span>
<span class="sd">        - Mininet hosts for routers and ground stations.</span>
<span class="sd">        - Links between nodes based on the graph edges.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="c1"># Create routers</span>
    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">torus_topo</span><span class="o">.</span><span class="n">satellites</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">):</span>
        <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="n">ip</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ip&quot;</span><span class="p">)</span>
        <span class="n">ip_intf</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">ip_addr</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">ip</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ip_intf</span> <span class="o">=</span> <span class="nb">format</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span>
            <span class="n">ip_addr</span> <span class="o">=</span> <span class="nb">format</span><span class="p">(</span><span class="n">ip</span><span class="o">.</span><span class="n">ip</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addHost</span><span class="p">(</span>
            <span class="n">name</span><span class="p">,</span>
            <span class="bp">cls</span><span class="o">=</span><span class="n">RouteNode</span><span class="p">,</span>
            <span class="n">ip</span><span class="o">=</span><span class="n">ip_intf</span><span class="p">)</span>

        <span class="n">frr_router</span><span class="p">:</span> <span class="n">FrrRouter</span> <span class="o">=</span> <span class="n">FrrRouter</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">ip_addr</span><span class="p">)</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">routers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">frr_router</span><span class="p">)</span>
        <span class="n">frr_router</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span>
            <span class="n">ospf</span><span class="o">=</span><span class="n">node</span><span class="p">[</span><span class="s2">&quot;ospf&quot;</span><span class="p">],</span>
            <span class="n">vtysh</span><span class="o">=</span><span class="n">node</span><span class="p">[</span><span class="s2">&quot;vtysh&quot;</span><span class="p">],</span>
            <span class="n">daemons</span><span class="o">=</span><span class="n">node</span><span class="p">[</span><span class="s2">&quot;daemons&quot;</span><span class="p">]</span>
        <span class="p">)</span>

    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">torus_topo</span><span class="o">.</span><span class="n">ground_stations</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">):</span>
        <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="n">ip</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ip&quot;</span><span class="p">)</span>
        <span class="n">ip_intf</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">ip_addr</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">ip</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ip_intf</span> <span class="o">=</span> <span class="nb">format</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span>
            <span class="n">ip_addr</span> <span class="o">=</span> <span class="nb">format</span><span class="p">(</span><span class="n">ip</span><span class="o">.</span><span class="n">ip</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addHost</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="n">RouteNode</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="n">ip_intf</span><span class="p">)</span>

        <span class="n">station</span> <span class="o">=</span> <span class="n">GroundStation</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">ip_addr</span><span class="p">,</span> <span class="n">node</span><span class="p">[</span><span class="s2">&quot;uplinks&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ground_stations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">station</span><span class="p">)</span>

    <span class="c1"># Create links between routers</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">edge</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">router1</span> <span class="o">=</span> <span class="n">name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">router2</span> <span class="o">=</span> <span class="n">name</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="c1"># Handle incomplete edged</span>
        <span class="k">if</span> <span class="n">edge</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ip&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">addLink</span><span class="p">(</span><span class="n">router1</span><span class="p">,</span> <span class="n">router2</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">ip1</span> <span class="o">=</span> <span class="n">edge</span><span class="p">[</span><span class="s2">&quot;ip&quot;</span><span class="p">][</span><span class="n">router1</span><span class="p">]</span>
        <span class="n">intf1</span> <span class="o">=</span> <span class="n">edge</span><span class="p">[</span><span class="s2">&quot;intf&quot;</span><span class="p">][</span><span class="n">router1</span><span class="p">]</span>

        <span class="n">ip2</span> <span class="o">=</span> <span class="n">edge</span><span class="p">[</span><span class="s2">&quot;ip&quot;</span><span class="p">][</span><span class="n">router2</span><span class="p">]</span>
        <span class="n">intf2</span> <span class="o">=</span> <span class="n">edge</span><span class="p">[</span><span class="s2">&quot;intf&quot;</span><span class="p">][</span><span class="n">router2</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">addLink</span><span class="p">(</span>
            <span class="n">router1</span><span class="p">,</span>
            <span class="n">router2</span><span class="p">,</span>
            <span class="n">intfName1</span><span class="o">=</span><span class="n">intf1</span><span class="p">,</span>
            <span class="n">intfName2</span><span class="o">=</span><span class="n">intf2</span><span class="p">,</span>
            <span class="n">params1</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="nb">format</span><span class="p">(</span><span class="n">ip1</span><span class="p">),</span> <span class="s2">&quot;delay&quot;</span><span class="p">:</span> <span class="s2">&quot;1ms&quot;</span><span class="p">},</span>
            <span class="n">params2</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="nb">format</span><span class="p">(</span><span class="n">ip2</span><span class="p">),</span> <span class="s2">&quot;delay&quot;</span><span class="p">:</span> <span class="s2">&quot;1ms&quot;</span><span class="p">},</span>
            <span class="bp">cls</span><span class="o">=</span><span class="n">mininet</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">TCLink</span><span class="p">,</span> 
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="emulation.mnet.frr_topo.RouteNode" class="doc doc-heading">
            <code>RouteNode</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="mininet.node.Node">Node</span></code></p>


        <p>Mininet node with a loopback.
Supports FrrRouters and ground sations.</p>
<p>Includes an optional loopback interface with a /31 subnet mask</p>






              <details class="quote">
                <summary>Source code in <code>emulation/mnet/frr_topo.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">RouteNode</span><span class="p">(</span><span class="n">mininet</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">Node</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Mininet node with a loopback.</span>
<span class="sd">    Supports FrrRouters and ground sations.</span>

<span class="sd">    Includes an optional loopback interface with a /31 subnet mask</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="n">mininet</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">Node</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>

        <span class="c1"># Optional loopback interface</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loopIntf</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">defaultIntf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># If we have a loopback, that is the default interface.</span>
        <span class="c1"># Otherwise use mininet default behavior.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">loopIntf</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">loopIntf</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">defaultIntf</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">Configure the node and create a loopback interface if needed.</span>

<span class="sd">Args:</span>
<span class="sd">    params (dict): Configuration parameters, including `ip` for setting a default IP address.</span>

<span class="sd">Creates:</span>
<span class="sd">    - A loopback interface if no matching interface is found for the specified IP.</span>
<span class="sd">&#39;&#39;&#39;</span>

        <span class="c1"># If we have a default IP and it is not an existing interface, create a</span>
        <span class="c1"># loopback.</span>
        <span class="k">if</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ip&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">match_found</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">ip</span> <span class="o">=</span> <span class="nb">format</span><span class="p">(</span><span class="n">ipaddress</span><span class="o">.</span><span class="n">IPv4Interface</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ip&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">ip</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">intf</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">intfs</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">intf</span><span class="o">.</span><span class="n">ip</span> <span class="o">==</span> <span class="n">ip</span><span class="p">:</span>
                    <span class="n">match_found</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">match_found</span><span class="p">:</span>
                <span class="c1"># Make a default interface</span>
                <span class="n">mininet</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">quietRun</span><span class="p">(</span><span class="s2">&quot;ip link add name loop type dummy&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">loopIntf</span> <span class="o">=</span> <span class="n">mininet</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">Intf</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;loop&quot;</span><span class="p">,</span> <span class="n">node</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">setIP</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ip</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set the IP address for the node.</span>

<span class="sd">        Args:</span>
<span class="sd">            ip (str): The IP address to set for the node.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1"># What is this for?</span>
        <span class="n">mininet</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">Node</span><span class="o">.</span><span class="n">setIP</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ip</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="emulation.mnet.frr_topo.RouteNode.config" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">config</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Configure the node and create a loopback interface if needed.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>params</code>
            </td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration parameters, including <code>ip</code> for setting a default IP address.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


<details class="creates" open>
  <summary>Creates</summary>
  <ul>
<li>A loopback interface if no matching interface is found for the specified IP.</li>
</ul>
</details>
            <details class="quote">
              <summary>Source code in <code>emulation/mnet/frr_topo.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span></pre></div></td><td class="code"><div><pre><span></span><code>    <span class="k">def</span> <span class="nf">config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">Configure the node and create a loopback interface if needed.</span>

<span class="sd">Args:</span>
<span class="sd">    params (dict): Configuration parameters, including `ip` for setting a default IP address.</span>

<span class="sd">Creates:</span>
<span class="sd">    - A loopback interface if no matching interface is found for the specified IP.</span>
<span class="sd">&#39;&#39;&#39;</span>

        <span class="c1"># If we have a default IP and it is not an existing interface, create a</span>
        <span class="c1"># loopback.</span>
        <span class="k">if</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ip&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">match_found</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">ip</span> <span class="o">=</span> <span class="nb">format</span><span class="p">(</span><span class="n">ipaddress</span><span class="o">.</span><span class="n">IPv4Interface</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ip&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">ip</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">intf</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">intfs</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">intf</span><span class="o">.</span><span class="n">ip</span> <span class="o">==</span> <span class="n">ip</span><span class="p">:</span>
                    <span class="n">match_found</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">match_found</span><span class="p">:</span>
                <span class="c1"># Make a default interface</span>
                <span class="n">mininet</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">quietRun</span><span class="p">(</span><span class="s2">&quot;ip link add name loop type dummy&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">loopIntf</span> <span class="o">=</span> <span class="n">mininet</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">Intf</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;loop&quot;</span><span class="p">,</span> <span class="n">node</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="emulation.mnet.frr_topo.RouteNode.setIP" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">setIP</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Set the IP address for the node.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>ip</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The IP address to set for the node.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>emulation/mnet/frr_topo.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">setIP</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ip</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Set the IP address for the node.</span>

<span class="sd">    Args:</span>
<span class="sd">        ip (str): The IP address to set for the node.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="c1"># What is this for?</span>
    <span class="n">mininet</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">Node</span><span class="o">.</span><span class="n">setIP</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ip</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="emulation.mnet.frr_topo.StubMininet" class="doc doc-heading">
            <code>StubMininet</code>


</h2>


    <div class="doc doc-contents ">


        <p>In order to run and test with out standing up an entire mininet environment (that is run as root),
we can stub out the mininet calls. This results in the mininet nodes being returned as None and code
needs to handle this case.</p>






              <details class="quote">
                <summary>Source code in <code>emulation/mnet/frr_topo.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">StubMininet</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    In order to run and test with out standing up an entire mininet environment (that is run as root),</span>
<span class="sd">    we can stub out the mininet calls. This results in the mininet nodes being returned as None and code</span>
<span class="sd">    needs to handle this case.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">configLinkStatus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node1</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">node2</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">linksBetween</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node1</span><span class="p">,</span> <span class="n">node2</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">getNodeByName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">addLink</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node1</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">node2</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">params1</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">params2</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">delLinkBetween</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node1</span><span class="p">,</span> <span class="n">node2</span><span class="p">):</span>
        <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>




  </div>

    </div>

</div></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js"></script>
        <script src="../../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
